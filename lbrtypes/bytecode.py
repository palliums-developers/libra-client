from enum import IntEnum
from lbrtypes.move_core.account_address import AccountAddress

class TransactionType(IntEnum):
    SIGNED_TRANSACTION = 0
    CHANGE_SET = 1
    BLOCK_METADATA = 2

class CodeType(IntEnum):
    ADD_CURRENCY = 50
    ADD_CURRENCY_TO_ACCOUNT = 51
    ADD_VALIDATOR = 52
    ALLOW_CHILD_ACCOUNTS = 53
    APPLY_FOR_ASSOCIATION_ADDRESS = 54
    APPLY_FOR_ASSOCIATION_PRIVILEGE = 55
    APPLY_FOR_CHILD_VASP_CREDENTIAL = 56
    APPLY_FOR_PARENT_CAPABILITY = 57
    APPLY_FOR_ROOT_VASP = 58
    APPROVED_PAYMENT = 59
    BURN = 60
    CANCEL_BURN = 61
    CREATE_ACCOUNT = 62
    CREATE_EMPTY_ACCOUNT = 63
    EMPTY_SCRIPT = 64
    GRANT_ASSOCIATION_ADDRESS = 65
    GRANT_ASSOCIATION_PRIVILEGE = 66
    GRANT_CHILD_ACCOUNT = 67
    GRANT_PARENT_ACCOUNT = 68
    GRANT_VASP_ACCOUNT = 69
    MINT_LBR = 70
    MINT = 71
    MODIFY_PUBLISHING_OPTION = 72
    PEER_TO_PEER = 73
    PEER_TO_PEER_WITH_METADATA = 74
    PREBURN = 75
    PUBLISH_SHARED_ED25519_PUBLIC_KEY = 76
    RECERTIFY_CHILD_ACCOUNT = 77
    REGISTER_APPROVED_PAYMENT = 78
    REGISTER_PREBURNER = 79
    REGISTER_VALIDATOR = 80
    REMOVE_ASSOCIATION_ADDRESS = 81
    REMOVE_ASSOCIATION_PRIVILEGE = 82
    REMOVE_CHILD_ACCOUNT = 83
    REMOVE_PARENT_ACCOUNT = 84
    REMOVE_VALIDATOR = 85
    ROTATE_AUTHENTICATION_KEY = 86
    ROTATE_CONSENSUS_PUBKEY = 87
    ROTATE_SHARED_ED25519_PUBLIC_KEY = 88
    UNMINT_LBR = 89
    UPDATE_EXCHANGE_RATE = 90
    UPDATE_LIBRA_VERSION = 91
    UPDATE_MINTING_ABILITY = 92
    PUBLISH_MODULE = 93

    CHANGE_SET = 97
    BLOCK_METADATA = 98

    UNKNOWN = 100

bytecodes = {
    "add_currency": b'\xa1\x1c\xeb\x0b\x01\x00\x08\x01O\x00\x00\x00\x06\x00\x00\x00\x02U\x00\x00\x00\x04\x00\x00\x00\x03Y\x00\x00\x00\x0b\x00\x00\x00\x04d\x00\x00\x00\x02\x00\x00\x00\x05f\x00\x00\x00\x1a\x00\x00\x00\x07\x80\x00\x00\x00C\x00\x00\x00\x08\xc3\x00\x00\x00\x10\x00\x00\x00\t\xd3\x00\x00\x00\x1b\x00\x00\x00\x00\x00\x00\x01\x00\x02\x01\x03\x02\x00\x01\x04\x00\x01\x00\x02\x05\x02\x03\x01\x01\x01\x05\x02\x03\x03\x01\x08\x00\x05\x08\x00\x01\x03\x03\n\x02\x00\x06\x03\x03\x01\x03\x03\n\x02\x01\t\x00\x06<SELF>\x0cFixedPoint32\x05Libra\x01T\x14create_from_rational\x11register_currency\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x04\x01\x0b\x00\n\x00\n\x01\x11\x00\x0c\x06\x0b\x06\n\x02\n\x03\n\x04\x0b\x058\x00\x02',
    "add_currency_to_account": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x06\x00\x00\x00\x04P\x00\x00\x00\x02\x00\x00\x00\x05R\x00\x00\x00\x04\x00\x00\x00\x07V\x00\x00\x00!\x00\x00\x00\x08w\x00\x00\x00\x10\x00\x00\x00\t\x87\x00\x00\x00\t\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x00\x01\x01\x00\x01\x00\x01\t\x00\x06<SELF>\x0cLibraAccount\x0cadd_currency\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x00\x02\x008\x00\x02',
    "add_validator": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00!\x00\x00\x00\x08j\x00\x00\x00\x10\x00\x00\x00\tz\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x0bLibraSystem\radd_validator\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',
    "allow_child_accounts": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x01\x00\x00\x00\x07G\x00\x00\x00!\x00\x00\x00\x08h\x00\x00\x00\x10\x00\x00\x00\tx\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x00\x00\x00\x06<SELF>\x04VASP\x14allow_child_accounts\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x11\x00\x02',
    "apply_for_association_address": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x01\x00\x00\x00\x07G\x00\x00\x00)\x00\x00\x00\x08p\x00\x00\x00\x10\x00\x00\x00\t\x80\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x00\x00\x00\x06<SELF>\x0bAssociation\x15apply_for_association\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x11\x00\x02',
    "apply_for_association_privilege": b"\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x06\x00\x00\x00\x04P\x00\x00\x00\x02\x00\x00\x00\x05R\x00\x00\x00\x04\x00\x00\x00\x07V\x00\x00\x00'\x00\x00\x00\x08}\x00\x00\x00\x10\x00\x00\x00\t\x8d\x00\x00\x00\t\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x00\x01\x01\x00\x01\x00\x01\t\x00\x06<SELF>\x0bAssociation\x13apply_for_privilege\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x00\x02\x008\x00\x02",
    "apply_for_child_vasp_credential": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00,\x00\x00\x00\x08u\x00\x00\x00\x10\x00\x00\x00\t\x85\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x04VASP\x1fapply_for_child_vasp_credential\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',
    "apply_for_parent_capability": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x01\x00\x00\x00\x07G\x00\x00\x00(\x00\x00\x00\x08o\x00\x00\x00\x10\x00\x00\x00\t\x7f\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x00\x00\x00\x06<SELF>\x04VASP\x1bapply_for_parent_capability\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x11\x00\x02',
    "apply_for_root_vasp": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\n\x00\x00\x00\x07P\x00\x00\x00+\x00\x00\x00\x08{\x00\x00\x00\x10\x00\x00\x00\t\x8b\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x04\n\x02\n\x02\n\x02\n\x02\x00\x06<SELF>\x04VASP\x1eapply_for_vasp_root_credential\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x06\x00\x0b\x00\x0b\x01\x0b\x02\x0b\x03\x11\x00\x02',
    "approved_payment": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x06\x00\x00\x00\x04P\x00\x00\x00\x02\x00\x00\x00\x05R\x00\x00\x00\x0b\x00\x00\x00\x07]\x00\x00\x00(\x00\x00\x00\x08\x85\x00\x00\x00\x10\x00\x00\x00\t\x95\x00\x00\x00\x11\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x00\x02\x04\x05\x03\n\x02\n\x02\x00\x01\t\x00\x06<SELF>\x0fApprovedPayment\x10deposit_to_payee\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x01\x06\x00\n\x00\n\x01\x0b\x02\x0b\x038\x00\x02',
    "burn": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x06\x00\x00\x00\x04P\x00\x00\x00\x02\x00\x00\x00\x05R\x00\x00\x00\x06\x00\x00\x00\x07X\x00\x00\x00\x12\x00\x00\x00\x08j\x00\x00\x00\x10\x00\x00\x00\tz\x00\x00\x00\x0b\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x00\x02\x01\x05\x00\x01\t\x00\x06<SELF>\x05Libra\x04burn\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x01\x03\x00\n\x008\x00\x02',
    "cancel_burn": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x06\x00\x00\x00\x04P\x00\x00\x00\x02\x00\x00\x00\x05R\x00\x00\x00\x06\x00\x00\x00\x07X\x00\x00\x00 \x00\x00\x00\x08x\x00\x00\x00\x10\x00\x00\x00\t\x88\x00\x00\x00\x0b\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x00\x02\x01\x05\x00\x01\t\x00\x06<SELF>\x0cLibraAccount\x0bcancel_burn\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x01\x03\x00\n\x008\x00\x02',
    "create_account": b"\xa1\x1c\xeb\x0b\x01\x00\x08\x01O\x00\x00\x00\x06\x00\x00\x00\x02U\x00\x00\x00\x05\x00\x00\x00\x03Z\x00\x00\x00\x12\x00\x00\x00\x04l\x00\x00\x00\x06\x00\x00\x00\x05r\x00\x00\x00\x1c\x00\x00\x00\x07\x8e\x00\x00\x00P\x00\x00\x00\x08\xde\x00\x00\x00\x10\x00\x00\x00\t\xee\x00\x00\x00'\x00\x00\x00\x00\x00\x00\x01\x00\x02\x01\x03\x01\x01\x01\x02\x04\x00\x01\x01\x01\x02\x05\x02\x01\x01\x01\x02\x06\x03\x04\x01\x01\x00\x06\x02\x06\x01\x06\x02\x05\n\x02\x00\x02\x05\x0b\x00\x01\t\x00\x01\x03\x01\x0b\x00\x01\t\x00\x03\x05\n\x02\x03\x01\t\x00\x06<SELF>\x05Libra\x0cLibraAccount\x01T\x16create_testnet_account\x07deposit\x14withdraw_from_sender\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x05\x01\r\x00\n\x00\x0b\x018\x00\n\x02\x06\x00\x00\x00\x00\x00\x00\x00\x00$\x03\x08\x00\x05\x0c\x00\n\x00\n\x028\x018\x02\x02",
    "create_empty_account": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x06\x00\x00\x00\x04P\x00\x00\x00\x02\x00\x00\x00\x05R\x00\x00\x00\x08\x00\x00\x00\x07Z\x00\x00\x00#\x00\x00\x00\x08}\x00\x00\x00\x10\x00\x00\x00\t\x8d\x00\x00\x00\r\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x00\x02\x02\x05\n\x02\x00\x01\t\x00\x06<SELF>\x0cLibraAccount\x0ecreate_account\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x01\x04\x00\n\x00\x0b\x018\x00\x02',
    "empty_script": b'\xa1\x1c\xeb\x0b\x01\x00\x05\x014\x00\x00\x00\x02\x00\x00\x00\x056\x00\x00\x00\x01\x00\x00\x00\x077\x00\x00\x00\x07\x00\x00\x00\x08>\x00\x00\x00\x10\x00\x00\x00\tN\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x06<SELF>\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x02',
    "grant_association_address": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00-\x00\x00\x00\x08v\x00\x00\x00\x10\x00\x00\x00\t\x86\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x0bAssociation\x19grant_association_address\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',
    "grant_association_privilege": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x06\x00\x00\x00\x04P\x00\x00\x00\x02\x00\x00\x00\x05R\x00\x00\x00\x06\x00\x00\x00\x07X\x00\x00\x00#\x00\x00\x00\x08{\x00\x00\x00\x10\x00\x00\x00\t\x8b\x00\x00\x00\x0b\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x00\x02\x01\x05\x00\x01\t\x00\x06<SELF>\x0bAssociation\x0fgrant_privilege\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x01\x03\x00\n\x008\x00\x02',
    "grant_child_account": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00 \x00\x00\x00\x08i\x00\x00\x00\x10\x00\x00\x00\ty\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x04VASP\x13grant_child_account\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',
    "grant_parent_account": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00$\x00\x00\x00\x08m\x00\x00\x00\x10\x00\x00\x00\t}\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x04VASP\x17grant_parent_capability\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',
    "grant_vasp_account": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00\x17\x00\x00\x00\x08`\x00\x00\x00\x10\x00\x00\x00\tp\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x04VASP\ngrant_vasp\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',

    "mint_lbr": b'\xa1\x1c\xeb\x0b\x01\x00\x08\x01O\x00\x00\x00\x0c\x00\x00\x00\x02[\x00\x00\x00\x11\x00\x00\x00\x03l\x00\x00\x00\x17\x00\x00\x00\x04\x83\x00\x00\x00\x0e\x00\x00\x00\x05\x91\x00\x00\x00T\x00\x00\x00\x07\xe5\x00\x00\x00X\x00\x00\x00\x08=\x01\x00\x00\x10\x00\x00\x00\tM\x01\x00\x00A\x00\x00\x00\x00\x00\x00\x01\x00\x02\x00\x03\x00\x04\x00\x05\x04\x06\x01\x01\x01\x01\x06\x02\x00\x02\x06\x02\x00\x03\x06\x01\x00\x05\x07\x00\x01\x01\x01\x05\x08\x02\x03\x01\x01\x05\t\x01\x04\x01\x01\x03\n\x05\x06\x00\x00\x08\x00\t\x02\x08\x02\t\x01\n\x01\x08\x01\t\x01\x05\x01\x03\x02\x05\x0b\x00\x01\t\x00\x00\x01\x0b\x00\x01\t\x00\x03\x03\x0b\x00\x01\x08\x01\x0b\x00\x01\x08\x02\x03\x0b\x00\x01\x08\x03\x0b\x00\x01\x08\x01\x0b\x00\x01\x08\x02\x08\x0b\x00\x01\x08\x01\x0b\x00\x01\x08\x01\x03\x0b\x00\x01\x08\x02\x0b\x00\x01\x08\x02\x03\x0b\x00\x01\x08\x03\x05\x01\x08\x01\x01\x08\x02\x01\x08\x03\x06<SELF>\x05Coin1\x05Coin2\x03LBR\x05Libra\x0cLibraAccount\x01T\x07balance\x07deposit\x14withdraw_from_sender\x06create\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x07\x1f\x00(\x0c\x08\n\x088\x00\x0c\x03\n\x088\x01\x0c\x06\n\x038\x02\x0c\x01\n\x068\x03\x0c\x04\n\x00\x0b\x01\x0b\x04\x11\x03\x0c\x05\x0c\x02\x0c\x07\n\x08\x0b\x078\x04\n\x08\x0b\x028\x05\n\x08\x0b\x058\x06\x02',
    "mint": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x11\x00\x00\x00\x04[\x00\x00\x00\x04\x00\x00\x00\x05_\x00\x00\x00\x14\x00\x00\x00\x07s\x00\x00\x00B\x00\x00\x00\x08\xb5\x00\x00\x00\x10\x00\x00\x00\t\xc5\x00\x00\x00\x1e\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x01\x03\x02\x03\x00\x01\x04\x04\x01\x01\x01\x00\x06\x02\x06\x02\x05\n\x02\x00\x01\x05\x01\x01\x02\x05\x03\x03\x05\n\x02\x03\x01\t\x00\x06<SELF>\x0cLibraAccount\x16create_testnet_account\x06exists\x0fmint_to_address\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x05\x01\x0c\x00\n\x00\x11\x01 \x03\x05\x00\x05\x08\x00\n\x00\x0b\x018\x00\n\x00\n\x028\x01\x02',
    "modify_publishing_option": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x04\x00\x00\x00\x07J\x00\x00\x00+\x00\x00\x00\x08u\x00\x00\x00\x10\x00\x00\x00\t\x85\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\n\x02\x00\x06<SELF>\rLibraVMConfig\x15set_publishing_option\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\x0b\x00\x11\x00\x02',
    "peer_to_peer": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x11\x00\x00\x00\x04[\x00\x00\x00\x04\x00\x00\x00\x05_\x00\x00\x00\x14\x00\x00\x00\x07s\x00\x00\x00B\x00\x00\x00\x08\xb5\x00\x00\x00\x10\x00\x00\x00\t\xc5\x00\x00\x00\x1e\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x01\x03\x02\x03\x00\x01\x04\x04\x01\x01\x01\x00\x06\x02\x06\x02\x05\n\x02\x00\x01\x05\x01\x01\x02\x05\x03\x03\x05\n\x02\x03\x01\t\x00\x06<SELF>\x0cLibraAccount\x16create_testnet_account\x06exists\x0fpay_from_sender\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x05\x01\x0c\x00\n\x00\x11\x01 \x03\x05\x00\x05\x08\x00\n\x00\n\x018\x00\n\x00\n\x028\x01\x02',
    "peer_to_peer_with_metadata": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x11\x00\x00\x00\x04[\x00\x00\x00\x04\x00\x00\x00\x05_\x00\x00\x00\x1c\x00\x00\x00\x07{\x00\x00\x00P\x00\x00\x00\x08\xcb\x00\x00\x00\x10\x00\x00\x00\t\xdb\x00\x00\x00"\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x01\x03\x02\x03\x00\x01\x04\x04\x01\x01\x01\x00\x06\x02\x06\x02\x05\n\x02\x00\x01\x05\x01\x01\x04\x05\x03\n\x02\n\x02\x05\x05\n\x02\x03\n\x02\n\x02\x01\t\x00\x06<SELF>\x0cLibraAccount\x16create_testnet_account\x06exists\x1dpay_from_sender_with_metadata\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x05\x01\x0e\x00\n\x00\x11\x01 \x03\x05\x00\x05\x08\x00\n\x00\x0b\x018\x00\n\x00\n\x02\x0b\x03\x0b\x048\x01\x02',
    "preburn": b'\xa1\x1c\xeb\x0b\x01\x00\x08\x01O\x00\x00\x00\x06\x00\x00\x00\x02U\x00\x00\x00\x05\x00\x00\x00\x03Z\x00\x00\x00\x0c\x00\x00\x00\x04f\x00\x00\x00\x04\x00\x00\x00\x05j\x00\x00\x00\x0c\x00\x00\x00\x07v\x00\x00\x00C\x00\x00\x00\x08\xb9\x00\x00\x00\x10\x00\x00\x00\t\xc9\x00\x00\x00\r\x00\x00\x00\x00\x00\x00\x01\x00\x02\x01\x03\x01\x01\x01\x01\x04\x00\x01\x01\x01\x02\x05\x02\x00\x01\x01\x01\x03\x00\x03\x01\x0b\x00\x01\t\x00\x00\x01\x03\x01\t\x00\x06<SELF>\x05Libra\x0cLibraAccount\x01T\x11preburn_to_sender\x14withdraw_from_sender\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x02\x01\x04\x00\n\x008\x008\x01\x02',
    "publish_shared_ed25519_public_key": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x04\x00\x00\x00\x07J\x00\x00\x00&\x00\x00\x00\x08p\x00\x00\x00\x10\x00\x00\x00\t\x80\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\n\x02\x00\x06<SELF>\x16SharedEd25519PublicKey\x07publish\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\x0b\x00\x11\x00\x02',
    "recertify_child_account": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00$\x00\x00\x00\x08m\x00\x00\x00\x10\x00\x00\x00\t}\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x04VASP\x17recertify_child_account\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',
    "register_approved_payment": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x04\x00\x00\x00\x07J\x00\x00\x00\x1f\x00\x00\x00\x08i\x00\x00\x00\x10\x00\x00\x00\ty\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\n\x02\x00\x06<SELF>\x0fApprovedPayment\x07publish\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\x0b\x00\x11\x00\x02',
    "register_preburner": b'\xa1\x1c\xeb\x0b\x01\x00\x08\x01O\x00\x00\x00\x04\x00\x00\x00\x02S\x00\x00\x00\x05\x00\x00\x00\x03X\x00\x00\x00\x0c\x00\x00\x00\x04d\x00\x00\x00\x04\x00\x00\x00\x05h\x00\x00\x00\n\x00\x00\x00\x07r\x00\x00\x001\x00\x00\x00\x08\xa3\x00\x00\x00\x10\x00\x00\x00\t\xb3\x00\x00\x00\x0b\x00\x00\x00\x00\x00\x00\x01\x01\x02\x01\x01\x01\x01\x03\x00\x01\x01\x01\x01\x04\x01\x00\x01\x01\x00\x02\x01\x02\x00\x01\x0b\x00\x01\t\x00\x01\t\x00\x06<SELF>\x05Libra\x07Preburn\x0bnew_preburn\x0fpublish_preburn\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x00\x03\x008\x008\x01\x02',
    "register_validator": b'\xa1\x1c\xeb\x0b\x01\x00\x08\x01O\x00\x00\x00\x0c\x00\x00\x00\x02[\x00\x00\x00\x0c\x00\x00\x00\x03g\x00\x00\x00\x11\x00\x00\x00\x04x\x00\x00\x00\x0c\x00\x00\x00\x05\x84\x00\x00\x00\x1b\x00\x00\x00\x07\x9f\x00\x00\x00q\x00\x00\x00\x08\x10\x01\x00\x00\x10\x00\x00\x00\t \x01\x00\x00>\x00\x00\x00\x00\x00\x00\x01\x00\x02\x00\x03\x00\x04\x00\x05\x01\x08\x02\x00\x02\x08\x02\x00\x03\x08\x01\x00\x04\x06\x00\x01\x01\x01\x04\x07\x02\x02\x01\x01\x05\t\x03\x02\x00\x00\x04\x01\x04\x00\x05\x01\x05\x00\x06\x01\x06\x01\x05\x01\x01\x00\x06\n\x02\n\x02\n\x02\n\x02\n\x02\n\x02\x01\x08\x00\x01\x08\x01\x01\x08\x02\x06<SELF>\x05Coin1\x05Coin2\x03LBR\x0cLibraAccount\x0fValidatorConfig\x10accepts_currency\x0cadd_currency\x01T\x1cregister_candidate_validator\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x1c\x00\x0b\x00\x0b\x01\x0b\x02\x0b\x03\x0b\x04\x0b\x05\x11\x02(\x0c\x06\n\x068\x00 \x03\x0e\x00\x05\x0f\x008\x01\n\x068\x02 \x03\x14\x00\x05\x15\x008\x03\n\x068\x04 \x03\x1a\x00\x05\x1b\x008\x05\x02',
    "remove_association_address": b'\xa1\x1c\xeb\x0b\x01\x00\x08\x01O\x00\x00\x00\x04\x00\x00\x00\x02S\x00\x00\x00\x04\x00\x00\x00\x03W\x00\x00\x00\x06\x00\x00\x00\x04]\x00\x00\x00\x02\x00\x00\x00\x05_\x00\x00\x00\x06\x00\x00\x00\x07e\x00\x00\x00&\x00\x00\x00\x08\x8b\x00\x00\x00\x10\x00\x00\x00\t\x9b\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x02\x00\x01\x03\x00\x01\x01\x01\x00\x02\x01\x05\x00\x01\x08\x00\x06<SELF>\x0bAssociation\x01T\x10remove_privilege\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x008\x00\x02',
    "remove_association_privilege": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x06\x00\x00\x00\x04P\x00\x00\x00\x02\x00\x00\x00\x05R\x00\x00\x00\x06\x00\x00\x00\x07X\x00\x00\x00$\x00\x00\x00\x08|\x00\x00\x00\x10\x00\x00\x00\t\x8c\x00\x00\x00\x0b\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x00\x02\x01\x05\x00\x01\t\x00\x06<SELF>\x0bAssociation\x10remove_privilege\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x01\x03\x00\n\x008\x00\x02',
    "remove_child_account": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00$\x00\x00\x00\x08m\x00\x00\x00\x10\x00\x00\x00\t}\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x04VASP\x17decertify_child_account\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',
    "remove_parent_account": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00%\x00\x00\x00\x08n\x00\x00\x00\x10\x00\x00\x00\t~\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x04VASP\x18remove_parent_capability\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',
    "remove_validator": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00$\x00\x00\x00\x08m\x00\x00\x00\x10\x00\x00\x00\t}\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x0bLibraSystem\x10remove_validator\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',
    "rotate_authentication_key": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x04\x00\x00\x00\x07J\x00\x00\x00.\x00\x00\x00\x08x\x00\x00\x00\x10\x00\x00\x00\t\x88\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\n\x02\x00\x06<SELF>\x0cLibraAccount\x19rotate_authentication_key\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\x0b\x00\x11\x00\x02',
    "rotate_consensus_pubkey": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x06\x00\x00\x00\x03C\x00\x00\x00\n\x00\x00\x00\x05M\x00\x00\x00\x04\x00\x00\x00\x07Q\x00\x00\x00\\\x00\x00\x00\x08\xad\x00\x00\x00\x10\x00\x00\x00\t\xbd\x00\x00\x00\x0c\x00\x00\x00\x00\x00\x00\x01\x00\x02\x02\x03\x00\x01\x00\x01\x04\x01\x01\x00\x01\n\x02\x00\x06<SELF>\x0bLibraSystem\x0fValidatorConfig!rotate_consensus_pubkey_of_sender\x16update_and_reconfigure\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x04\x00\x0b\x00\x11\x00\x11\x01\x02',
    "rotate_shared_ed25519_public_key": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x04\x00\x00\x00\x07J\x00\x00\x000\x00\x00\x00\x08z\x00\x00\x00\x10\x00\x00\x00\t\x8a\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\n\x02\x00\x06<SELF>\x16SharedEd25519PublicKey\x11rotate_sender_key\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\x0b\x00\x11\x00\x02',
    "unmint_lbr": b'\xa1\x1c\xeb\x0b\x01\x00\x08\x01O\x00\x00\x00\x0c\x00\x00\x00\x02[\x00\x00\x00\x11\x00\x00\x00\x03l\x00\x00\x00\x11\x00\x00\x00\x04}\x00\x00\x00\x06\x00\x00\x00\x05\x83\x00\x00\x00;\x00\x00\x00\x07\xbe\x00\x00\x00P\x00\x00\x00\x08\x0e\x01\x00\x00\x10\x00\x00\x00\t\x1e\x01\x00\x00#\x00\x00\x00\x00\x00\x00\x01\x00\x02\x00\x03\x00\x04\x00\x05\x04\x06\x01\x01\x01\x01\x06\x02\x00\x02\x06\x02\x00\x03\x06\x01\x00\x05\x07\x00\x01\x01\x01\x05\x08\x02\x03\x01\x01\x03\t\x04\x05\x00\x01\x07\x00\x08\x00\t\x02\x05\x0b\x00\x01\t\x00\x00\x01\x03\x01\x0b\x00\x01\t\x00\x01\x0b\x00\x01\x08\x03\x02\x0b\x00\x01\x08\x01\x0b\x00\x01\x08\x02\x04\x0b\x00\x01\x08\x01\x0b\x00\x01\x08\x02\x0b\x00\x01\x08\x03\x05\x01\x08\x03\x01\x08\x01\x01\x08\x02\x06<SELF>\x05Coin1\x05Coin2\x03LBR\x05Libra\x0cLibraAccount\x01T\x07deposit\x14withdraw_from_sender\x06unpack\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x06\x10\x00(\x0c\x04\n\x008\x00\x0c\x03\x0b\x03\x11\x02\x0c\x02\x0c\x01\n\x04\x0b\x018\x01\n\x04\x0b\x028\x02\x02',
    "update_exchange_rate": b'\xa1\x1c\xeb\x0b\x01\x00\x08\x01O\x00\x00\x00\x06\x00\x00\x00\x02U\x00\x00\x00\x04\x00\x00\x00\x03Y\x00\x00\x00\x0b\x00\x00\x00\x04d\x00\x00\x00\x02\x00\x00\x00\x05f\x00\x00\x00\n\x00\x00\x00\x07p\x00\x00\x00J\x00\x00\x00\x08\xba\x00\x00\x00\x10\x00\x00\x00\t\xca\x00\x00\x00\x13\x00\x00\x00\x00\x00\x00\x01\x00\x02\x01\x03\x02\x00\x01\x04\x00\x01\x00\x02\x05\x01\x02\x01\x01\x01\x03\x02\x03\x03\x01\x08\x00\x00\x01\t\x00\x06<SELF>\x0cFixedPoint32\x05Libra\x01T\x14create_from_rational\x18update_lbr_exchange_rate\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x01\x07\x00\n\x00\n\x01\x11\x00\x0c\x02\x0b\x028\x00\x02',
    "update_libra_version": b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00\x18\x00\x00\x00\x08a\x00\x00\x00\x10\x00\x00\x00\tq\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x03\x00\x06<SELF>\x0cLibraVersion\x03set\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x00\n\x00\x11\x00\x02',
    "update_minting_ability": b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x06\x00\x00\x00\x04P\x00\x00\x00\x02\x00\x00\x00\x05R\x00\x00\x00\x06\x00\x00\x00\x07X\x00\x00\x00$\x00\x00\x00\x08|\x00\x00\x00\x10\x00\x00\x00\t\x8c\x00\x00\x00\x0b\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x00\x02\x01\x01\x00\x01\t\x00\x06<SELF>\x05Libra\x16update_minting_ability\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x01\x03\x00\n\x008\x00\x02',

    "token": b'\xa1\x1c\xeb\x0b\x01\x00\x05\x014\x00\x00\x00\x02\x00\x00\x00\x026\x00\x00\x00\x04\x00\x00\x00\x07:\x00\x00\x00\x16\x00\x00\x00\x08P\x00\x00\x00\x10\x00\x00\x00\n`\x00\x00\x00\x05\x00\x00\x00\x00\x00\x00\x01\x02\x00\x07Violas1\x01T\x0bdummy_fieldrW\xc2A~M\x108\xe1\x81|\x8f(:\xce.\x00\x02\x01\x02\x01',

}

type_to_code_map = {
    CodeType.ADD_CURRENCY: bytecodes["add_currency"],
    CodeType.ADD_CURRENCY_TO_ACCOUNT: bytecodes["add_currency_to_account"],
    CodeType.ADD_VALIDATOR: bytecodes["add_validator"],
    CodeType.ALLOW_CHILD_ACCOUNTS: bytecodes["allow_child_accounts"],
    CodeType.APPLY_FOR_ASSOCIATION_ADDRESS: bytecodes["apply_for_association_address"],
    CodeType.APPLY_FOR_ASSOCIATION_PRIVILEGE: bytecodes["apply_for_association_privilege"],
    CodeType.APPLY_FOR_CHILD_VASP_CREDENTIAL: bytecodes["apply_for_child_vasp_credential"],
    CodeType.APPLY_FOR_PARENT_CAPABILITY: bytecodes["apply_for_parent_capability"],
    CodeType.APPLY_FOR_ROOT_VASP: bytecodes["apply_for_root_vasp"],
    CodeType.APPROVED_PAYMENT: bytecodes["approved_payment"],
    CodeType.BURN: bytecodes["burn"],
    CodeType.CANCEL_BURN: bytecodes["cancel_burn"],
    CodeType.CREATE_ACCOUNT: bytecodes["create_account"],
    CodeType.CREATE_EMPTY_ACCOUNT: bytecodes["create_empty_account"],
    CodeType.EMPTY_SCRIPT: bytecodes["empty_script"],
    CodeType.GRANT_ASSOCIATION_ADDRESS: bytecodes["grant_association_address"],
    CodeType.GRANT_ASSOCIATION_PRIVILEGE: bytecodes["grant_association_privilege"],
    CodeType.GRANT_CHILD_ACCOUNT: bytecodes["grant_child_account"],
    CodeType.GRANT_PARENT_ACCOUNT: bytecodes["grant_parent_account"],
    CodeType.GRANT_VASP_ACCOUNT: bytecodes["grant_vasp_account"],
    CodeType.MINT_LBR: bytecodes["mint_lbr"],
    CodeType.MINT: bytecodes["mint"],
    CodeType.MODIFY_PUBLISHING_OPTION: bytecodes["modify_publishing_option"],
    CodeType.PEER_TO_PEER: bytecodes["peer_to_peer"],
    CodeType.PEER_TO_PEER_WITH_METADATA: bytecodes["peer_to_peer_with_metadata"],
    CodeType.PREBURN: bytecodes["preburn"],
    CodeType.PUBLISH_SHARED_ED25519_PUBLIC_KEY: bytecodes["publish_shared_ed25519_public_key"],
    CodeType.RECERTIFY_CHILD_ACCOUNT: bytecodes["recertify_child_account"],
    CodeType.REGISTER_APPROVED_PAYMENT: bytecodes["register_approved_payment"],
    CodeType.REGISTER_PREBURNER: bytecodes["register_preburner"],
    CodeType.REGISTER_VALIDATOR: bytecodes["register_validator"],
    CodeType.REMOVE_ASSOCIATION_ADDRESS: bytecodes["remove_association_address"],
    CodeType.REMOVE_ASSOCIATION_PRIVILEGE: bytecodes["remove_association_privilege"],
    CodeType.REMOVE_CHILD_ACCOUNT: bytecodes["remove_child_account"],
    CodeType.REMOVE_PARENT_ACCOUNT: bytecodes["remove_parent_account"],
    CodeType.REMOVE_VALIDATOR: bytecodes["remove_validator"],
    CodeType.ROTATE_AUTHENTICATION_KEY: bytecodes["rotate_authentication_key"],
    CodeType.ROTATE_CONSENSUS_PUBKEY: bytecodes["rotate_consensus_pubkey"],
    CodeType.ROTATE_SHARED_ED25519_PUBLIC_KEY: bytecodes["rotate_shared_ed25519_public_key"],
    CodeType.UNMINT_LBR: bytecodes["unmint_lbr"],
    CodeType.UPDATE_EXCHANGE_RATE: bytecodes["update_exchange_rate"],
    CodeType.UPDATE_LIBRA_VERSION: bytecodes["update_libra_version"],
    CodeType.UPDATE_MINTING_ABILITY: bytecodes["update_minting_ability"],
    CodeType.PUBLISH_MODULE: bytecodes["token"],
}

code_to_type_map = { v:k for k, v in type_to_code_map.items()}

default_module_address = bytes.fromhex("7257c2417e4d1038e1817c8f283ace2e")

def get_code_type(code: bytes):
    if isinstance(code, str):
        code = bytes.fromhex(code)
    type = code_to_type_map.get(code)
    if type:
        return type
    return CodeType.UNKNOWN

def get_code(type, module_address=None):
    code = type_to_code_map.get(type)
    if code:
        if module_address:
            module_address = AccountAddress.normalize_to_bytes(module_address)
            code = code.replace(default_module_address, module_address)
        return code



# def get_transaction_name(code):
#     for k, v in bytecodes.items():
#         if code == v:
#             return k+"_transaction"
#     return "unknown transaction"
#
# def get_code_by_jsonfile(script_file):
#     with open(script_file) as f:
#         amap = json.load(f)
#         return bytes(amap['code'])
#
# def get_code_by_filename(script_file):
#     with open(script_file, 'rb') as f:
#         code = f.read()
#         return code